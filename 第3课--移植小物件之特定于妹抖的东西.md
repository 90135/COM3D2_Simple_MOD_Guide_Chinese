# 第 3 课，移植小物件之特定于妹抖的东西

所谓移植，就是把其他地方的模型搬到妹抖里来。

因为做一个完整的模型是很麻烦的，所以我们先从移植学起


## 注意事项

如果你不确定要移植什么，导入多个模型参考后

决定要移植时，需要不保存工程，重开 blender

否则你删除模型时只是删除了网格，并没有删除贴图

以后你要处理贴图时会非常难受


## 骨骼类型

在 COM3D2 的 MOD 中，大致有 2 种骨骼，我把它们称为（不知道别人怎么叫的）
- **全身骨骼**，意思就是这个物品有完整的全身骨骼
- **物件骨骼**，意思就是这个物体只有基础骨骼和自己的一些骨骼

### 全身骨骼
我们第一课修改的袜子就是全身骨骼，导入后可以看到有完整的身体骨骼

你可以把这个隐藏，然后点左上角的添加-CM3D2-身体001（下面有图）来添加一个身体，你会发现骨架是一模一样的，除了这个袜子的丝带上面有额外骨骼

![图片](https://github.com/user-attachments/assets/bcc664bf-4757-4425-a670-68d5bd29b7eb)


### 物件骨骼
本人网盘里面有个 `改造_可以上下移动和左右摇动的vibe_proj3_COM専用_動くバイブMOD_240806.zip`

这个就是物件骨骼，你可以导入看一下

可以看到只有 X 轴（红色）的基础骨骼，和 Y 轴（绿色）的物体自己个骨骼。

基础骨骼是必须有的，物体自己的骨骼不一定要有

![图片](https://github.com/user-attachments/assets/b0063372-bcd5-4f81-80e1-af20b60dfbdc)


## 移植一个 MMD 模型
这次我们移植左边这个翅膀

https://bowlroll.net/file/87122

![073dfc61-02b5-454d-ad19-1ab616bc2e98](https://github.com/user-attachments/assets/9aa8e75b-619a-4a77-a2e6-77efff3a73cd)


我们在移植时，要先查看作者写的条款：

这个模型说了是 OK 的

```
自動はばたきモデルセット 規約
DLいただきありがとうございます。
このデータを使用したことで何か問題や不利益等いかなる損失が発生しても、私は一切の責任を負いません。

改造パーツ流用再配布等ご自由にしていただいてかまいませんが、くるっくーと銀獅式モデルのボーンは そちらの規約に従ってください。
テクスチャ製作者の方のクレジットは消さないで下さい。

何かありましたらメールください。不具合のご指摘はもちろん、些細なことでもアドバイスなどいただけると うれしいです。
hiro_k_mmd@nifty.com

動画
https://youtu.be/EOnZhy2RAx0
http://www.nicovideo.jp/watch/sm27356325

2015.10.10
hiro K

製作にあたり下記のものを使用・参考にさせていただきました。ありがとうございました。

羽テクスチャ by エリー（pixiv）
http://www.pixiv.net/member_illust.php?id=3226439

アゲハチョウテクスチャ by craftsmanspace.com
http://free-illustrations.gatag.net/2014/03/12/110000.html

ピストン構造 by Furia
```

下载后注意解压时要使用语言编码，不然是乱码

![图片](https://github.com/user-attachments/assets/0002623c-30fa-47b3-bc6e-53d52ac38dbd)

### 导入模型

解压后我们会看到一些 .pmx 格式的 MMD 模型

要导入这个格式的模型，我们需要安装 MMD 插件，链接在首页，

安装后就有导入按钮了

![图片](https://github.com/user-attachments/assets/f3ef5b5b-f144-42fb-80cd-01163e6c1821)

选择 `蝶_butterfly.pmx` 导入

![图片](https://github.com/user-attachments/assets/8a40daf4-ba19-4db9-842e-ddccbebd2643)

导入后把空物体，骨架什么的全部删掉（保留骨骼什么的我可能不会教）

只留下网格

![图片](https://github.com/user-attachments/assets/64472230-8c38-43ab-b8c8-edf3249271ff)

物体模式把定点组全部删掉

![图片](https://github.com/user-attachments/assets/b49872c5-faec-4e8d-bd40-1f913bd40318)

然后我们添加一个身体001

![图片](https://github.com/user-attachments/assets/fec4ac66-eeb0-4aa4-be38-9444ec7fb4ac)

### 调整大小

你会发现身体比翅膀大多了

![图片](https://github.com/user-attachments/assets/ea2778b4-0dd4-497a-85bb-1c56ef8c4ec0)

点击右上角可以切换正交视图

![图片](https://github.com/user-attachments/assets/d542f95e-8b37-44ad-9d3a-cccd15e0083a)

我们用 G 键 和 S 键来调整大小和位置

按下 G 或 S 后，可以按轴向来限制位置，比如你只想在 X 轴移动，就按一下 X

调整好大小后，需要应用变换，否则你导入游戏内，会发现怎么还是小号的

![图片](https://github.com/user-attachments/assets/f5812a55-aa1f-4fae-bd83-aff2e40fb86c)


### 绑定骨架

物体模式，在这里点击物体，然后按住shift，把它拖到 body001 骨架上（设置父级）

![图片](https://github.com/user-attachments/assets/ebf05833-92d4-456c-8498-a699c6d0ab51)

![图片](https://github.com/user-attachments/assets/8d312907-2099-4ceb-9260-68ca63bf3a11)


### 转换材质

你现在可以忘掉你学习的 blender 材质教程了，除了 UV 图。

因为妹抖内的材质和 blender 没有半毛钱关系。

选择材质（这个模型只有一个材质），这里有个更改为 COM3D2，点它

注意看下面 MMD 的贴图信息显示的是哪张图

![图片](https://github.com/user-attachments/assets/d119a33c-fdbd-45b6-8181-d2b0285bb293)


种类就是着色器，直接确定就行了，我建议直接在游戏内用 AccEX 改，因为可以实时查看

![图片](https://github.com/user-attachments/assets/ea343737-e1af-478a-be59-9de889de8c5f)


![图片](https://github.com/user-attachments/assets/4e9aa5f8-066b-495f-ba40-7babd5ec966a)

材料（材质）名称，简易改成模组名+部位名 或者 作者名+部位名什么的，以免和别人冲突

虽然材料名称不是全局的，不会和别人冲突，但是下面的贴图会

下面的贴图名建议和材质名称一样，这里为了让你在后续有所区分，加了贴图二字

![图片](https://github.com/user-attachments/assets/37d54a0f-3ff2-4b20-849b-e4151cddfe77)


还记得刚刚 MMD 的贴图信息显示的是哪张图片吗？

我们这里只需要 `toumei.png`，至于 `to_00.bmp` 我这里不教

![图片](https://github.com/user-attachments/assets/1d14160f-c53c-47b5-9975-11a0572838a2)

改成你刚刚设置的贴图名，然后转成 .tex

![图片](https://github.com/user-attachments/assets/4c4bfa6d-f9bb-4efb-b715-39239fb2e54c)

_ShadowTex 第一课有稍微说一下，如果你不想要阴影效果，可以设置成一样的
重复的会变成 .001 但是不用管，实际上读的是同一张图

![图片](https://github.com/user-attachments/assets/aa5fdbc7-fdc8-4866-a618-4d87aed7af8c)


### 物体跟随原理

我先不解释，你先跟着做一下

切换到编辑模式，全选翅膀的网格

（选择技巧，右上角有个透视模式，在复杂的模型用透视模式选择可以直接选到对面的东西，不需要来回拖视角）

新建一个顶点组，改名为 `Bip01 R Hand`，然后在全选顶点的情况下点击指定

![图片](https://github.com/user-attachments/assets/338bdd26-0605-4262-9ad8-59fb90897ad7)

#### 导出

然后切换回物体模式，选择翅膀，导出 .model，我们这里导出到 `learn_class3.model`

把它放进你的 MOD 文件夹，还记得吗，我们还缺一个 .menu

![图片](https://github.com/user-attachments/assets/60d82d84-4275-4298-b721-f07f3456e557)

从别的地方找一个 .menu 来，用第一课的也行，改名为 learn_class3.menu

把 マテリアル変更 （材质变更）删掉，因为我们这次不用单独的 .mate 文件

然后指定我们刚刚做的文件。

![图片](https://github.com/user-attachments/assets/8d8c759b-a869-4c54-a35e-c2548d3367af)

icons 这栏，我们没有做图标（并没有 learn_class3_i_.tex 的文件），所以等下会显示为条纹格子

或者你想做也行，图标大小 80x80

![图片](https://github.com/user-attachments/assets/2d4dede4-d1fc-4950-9345-898bf73c35d5)

然后启动游戏












## 在 Blender 内预览贴图

